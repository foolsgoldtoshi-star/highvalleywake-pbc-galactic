{:deps {zprint/zprint {:mvn/version "1.2.9"}
        org.clojure/clojurescript {:mvn/version "1.11.132"}}

 :tasks
 {:requires ([babashka.fs :as fs]
             [babashka.process :refer [shell]]
             [clojure.string :as str])

  ;; ğŸŒŒ GALACTIC INFRASTRUCTURE TASKS
  
  build:cljs-docs {:doc "Generate ClojureScript documentation DSL"
                   :task (do (println "ğŸ§¬ Generating ClojureScript documentation...")
                             (shell {:dir "site-dsl"} "npm" "ci")
                             (shell {:dir "site-dsl"} "npx" "shadow-cljs" "compile" "node-script")
                             (shell {:dir "site-dsl"} "node" "target/main.js")
                             (println "ğŸŠ ClojureScript docs generation complete"))}

  build:localhost {:doc "Build optimized for localhost development"
                   :task (do (println "ğŸŒ± Building for localhost development...")
                             (shell {:dir "build-systems/localhost"} "cp" "svelte.config.js" "../../web/")
                             (shell {:dir "web"} "npm" "ci")
                             (shell {:dir "web"} "npm" "run" "build")
                             (println "ğŸ–¤ Localhost build complete"))}

  build:github-pages {:doc "Build optimized for GitHub Pages deployment"
                      :task (do (println "ğŸŒ Building for GitHub Pages...")
                                (shell {:dir "build-systems/github-pages"} "cp" "svelte.config.js" "../../web/")
                                (shell {:dir "web" :env {"GITHUB_PAGES" "true"}} "npm" "ci")
                                (shell {:dir "web" :env {"GITHUB_PAGES" "true"}} "npm" "run" "build")
                                (println "ğŸš€ GitHub Pages build complete"))}

  build:all-localhost {:doc "Complete localhost build pipeline"
                       :depends [build:cljs-docs build:localhost]
                       :task (println "ğŸŒ½ Complete localhost infrastructure ready!")}

  build:all-github-pages {:doc "Complete GitHub Pages build pipeline"
                          :depends [build:cljs-docs build:github-pages]
                          :task (println "ğŸŒŒ Complete GitHub Pages infrastructure ready!")}

  ;; ğŸ§¹ MAINTENANCE
  clean {:doc "Clean all build artifacts"
         :task (do (fs/delete-tree "web/dist" {:force true})
                   (fs/delete-tree "web/.svelte-kit" {:force true})
                   (fs/delete-tree "site-dsl/target" {:force true})
                   (println "ğŸ§¹ Build artifacts cleaned"))}

  ;; ğŸ“Š HEALTH & TESTING
  test:builds {:doc "Test both build variants"
               :task (do (println "ğŸ” Testing galactic build pipelines...")
                         (shell "bb" "clean")
                         (println "1. Testing localhost build...")
                         (shell "bb" "build:all-localhost")
                         (println "2. Testing GitHub Pages build...")
                         (shell "bb" "build:all-github-pages")
                         (println "ğŸŠ Both build variants successful!"))}}}

;; ğŸŒŒ Enhanced Babashka configuration for galactic infrastructure
;; ğŸ–¤ğŸ¤ğŸ’™ Built with functional programming for post-industrial civilization